# GuiComboBox
#include &lt;GuiComboBox.au3> #include &lt;ScreenCapture.au3> #include &lt;GUIConstantsEx.au3> #include &lt;WindowsConstants.au3>  Opt("MustDeclareVars", 1)  ; #VARIABLES# Global Const $WM_CAP_START = 0x400 Global Const $WM_CAP_GRAB_FRAME_NOSTOP = $WM_CAP_START + 61 Global Const $WM_CAP_FILE_SAVEDIBA = $WM_CAP_START + 25 Global Const $WM_CAP_SET_PREVIEW = $WM_CAP_START + 50 Global Const $WM_CAP_SET_PREVIEWRATE = $WM_CAP_START + 52 Global Const $WM_CAP_DRIVER_CONNECT = $WM_CAP_START + 10 Global Const $WM_CAP_SET_SCALE = $WM_CAP_START + 53 Global Const $WM_CAP_SET_OVERLAY = $WM_CAP_START + 51  Global $iWebcam = 1, $FrameRate, $Vmr9 = 1, $oVideoWindow, $oVmr9, $aWebcamList[9] Global $oBasicVideo, $oBuild, $oCapture[9], $oGraph, $oMediaControl, $oDevEnum, $oEnum Global Const $S_OK = 0 Global Const $sIID_IMediaControl = '{56A868B1-0AD4-11CE-B03A-0020AF0BA770}' Global Const $sCLSID_VideoInputDeviceCategory = '{860bb310-5d01-11d0-bd3b-00a0c911ce86}' Global Const $PIN_CATEGORY_CAPTURE = '{fb6c4281-0353-11d1-905f-0000c0cc16ba}' Global Const $PIN_CATEGORY_PREVIEW = '{fb6c4282-0353-11d1-905f-0000c0cc16ba}' Global Const $MEDIATYPE_Video = '{73646976-0000-0010-8000-00aa00389b71}' Global Const $sCLSID_VideoMixingRenderer9 = '{51b4abf3-748f-4e3b-a276-c828330e926a}' Global Const $sCLSID_FilterGraph = "{E436EBB3-524F-11CE-9F53-0020AF0BA770}" Global Const $sIID_IGraphBuilder = "{56A868A9-0AD4-11CE-B03A-0020AF0BA770}" Global Const $tagIGraphBuilder = "AddFilter hresult(ptr;wstr);" &amp; "RemoveFilter hresult(ptr);" &amp; "EnumFilters hresult(ptr*);" &amp; "FindFilterByName hresult(wstr;ptr*);" &amp; "ConnectDirect hresult(ptr;ptr;ptr);" &amp; "Reconnect hresult(ptr);" &amp; "Disconnect hresult(ptr);" &amp; "SetDefaultSyncSource hresult();" &amp; "Connect hresult(ptr;ptr);" &amp; "Render hresult(ptr);" &amp; "RenderFile hresult(wstr;ptr);" &amp; "AddSourceFilter hresult(wstr;wstr;ptr*);" &amp; "SetLogFile hresult(dword_ptr);" &amp; "Abort hresult();" &amp; "ShouldOperationContinue hresult();" Global Const $sCLSID_CaptureGraphBuilder2 = '{BF87B6E1-8C27-11D0-B3F0-00AA003761C5}' Global Const $sIID_ICaptureGraphBuilder2 = '{93e5a4e0-2d50-11d2-abfa-00a0c9c6e38d}' Global Const $tagICaptureGraphBuilder2 = "SetFiltergraph hresult(ptr);" &amp; "GetFiltergraph hresult(ptr*);" &amp; "SetOutputFileName hresult(clsid;wstr;ptr*;ptr*);" &amp; "FindInterface hresult(clsid;clsid;ptr;clsid;ptr*);" &amp; "RenderStream hresult(clsid;clsid;ptr;ptr;ptr);" &amp; "ControlStream hresult(clsid;clsid;ptr;ptr;ptr;word;word);" &amp; "AllocCapFile hresult(wstr;int64);" &amp; "CopyCaptureFile hresult(wstr;wstr;int;ptr*);" &amp; "FindPin hresult(ptr;int;clsid;clsid;bool;int;ptr*);" Global Const $sCLSID_SystemDeviceEnum = '{62BE5D10-60EB-11d0-BD3B-00A0C911CE86}' Global Const $sIID_ICreateDevEnum = '{29840822-5b84-11d0-bd3b-00a0c911ce86}' Global Const $tagICreateDevEnum = "CreateClassEnumerator hresult( clsid ; ptr*; dword );" Global Const $sIID_IEnumMoniker = '{00000102-0000-0000-c000-000000000046}' Global Const $tagIEnumMoniker = "Next hresult(dword;ptr*;dword*);" &amp; "Skip hresult(dword);" &amp; "Reset hresult();" &amp; "Clone hresult(ptr*);" Global Const $sIID_IBaseFilter = '{56a86895-0ad4-11ce-b03a-0020af0ba770}' Global Const $tagIBaseFilter = "GetClassID hresult(ptr*);" &amp; "Stop hresult();" &amp; "Pause hresult();" &amp; "Run hresult(int64);" &amp; "GetState hresult(dword;dword*);" &amp; "SetSyncSource hresult(ptr);" &amp; "GetSyncSource hresult(ptr*);" &amp; "EnumPins hresult(ptr*);" &amp; "FindPin hresult(wstr;ptr*);" &amp; "QueryFilterInfo hresult(ptr*);" &amp; "JoinFilterGraph hresult(ptr;wstr);" &amp; "QueryVendorInfo hresult(wstr*);" Global Const $sIID_IMoniker = '{0000000f-0000-0000-C000-000000000046}' Global Const $tagIMoniker = "GetClassID hresult( clsid )" &amp; "IsDirty hresult(  );" &amp; "Load hresult( ptr );" &amp; "Save hresult( ptr, bool );" &amp; "GetSizeMax hresult( uint64 );" &amp; "BindToObject hresult( ptr;ptr;clsid;ptr*);" &amp; "BindToStorage hresult( ptr;ptr;clsid;ptr*);" &amp; "Reduce hresult( ptr;dword;ptr*;ptr*);" &amp; "ComposeWith hresult( ptr;bool;ptr*);" &amp; "Enum hresult( bool;ptr*);" &amp; "IsEqual hresult( ptr);" &amp; "Hash hresult( dword*);" &amp; "IsRunning hresult( ptr;ptr;ptr);" &amp; "GetTimeOfLastChange hresult( ptr;ptr;int64*);" &amp; "Inverse hresult( ptr*);" &amp; "CommonPrefixWith hresult( ptr;ptr*);" &amp; "RelativePathTo hresult( ptr;ptr*);" &amp; "GetDisplayName hresult( ptr;ptr;wstr*);" &amp; "ParseDisplayName hresult( ptr;ptr;wstr;ulong*;ptr*);" &amp; "IsSystemMoniker hresult( dword*);" Global Const $tagIDispatch = "GetTypeInfoCount hresult(dword*);" &amp; "GetTypeInfo hresult(dword;dword;ptr*);" &amp; "GetIDsOfNames hresult(clsid;ptr;dword;dword;ptr);" &amp; "Invoke hresult(dword;clsid;dword;word;ptr;ptr;ptr;dword*);" Global Const $sIID_IVideoWindow = "{56A868B4-0AD4-11CE-B03A-0020AF0BA770}" Global Const $tagIVideoWindow = $tagIDispatch &amp; "put_Caption hresult(bstr);" &amp; "get_Caption hresult(bstr*);" &amp; "put_WindowStyle hresult(long);" &amp; "get_WindowStyle hresult(long*);" &amp; "put_WindowStyleEx hresult(long);" &amp; "put_WindowStyleEx hresult(long*);" &amp; "put_AutoShow hresult(long);" &amp; "get_AutoShow hresult(long*);" &amp; "put_WindowState hresult(long);" &amp; "get_WindowState hresult(long*);" &amp; "put_BackgroundPalette hresult(long);" &amp; "get_BackgroundPalette hresult(long*);" &amp; "put_Visible hresult(long);" &amp; "get_Visible hresult(long*);" &amp; "put_Left hresult(long);" &amp; "get_Left hresult(long*);" &amp; "put_Width hresult(long);" &amp; "get_Width hresult(long*);" &amp; "put_Top hresult(long);" &amp; "get_Top hresult(long*);" &amp; "put_Height hresult(long);" &amp; "get_Height hresult(long*);" &amp; "put_Owner hresult(long_ptr);" &amp; "get_Owner hresult(long_ptr*);" &amp; "put_MessageDrain hresult(long_ptr);" &amp; "get_MessageDrain hresult(long_ptr*);" &amp; "get_BorderColor hresult(long*);" &amp; "put_BorderColor hresult(long);" &amp; "get_FullScreenMode hresult(long*);" &amp; "put_FullScreenMode hresult(long);" &amp; "SetWindowForeground hresult(long);" &amp; "NotifyOwnerMessage hresult(long_ptr;long;long_ptr;long_ptr);" &amp; "SetWindowPosition hresult(long;long;long;long);" &amp; "GetWindowPosition hresult(long*;long*;long*;long*);" &amp; "GetMinIdealImageSize hresult(long*;long*);" &amp; "GetMaxIdealImageSize hresult(long*;long*);" &amp; "GetRestorePosition hresult(long*;long*;long*;long*);" &amp; "HideCursor hresult(long);" &amp; "IsCursorHidden hresult(long*);" Global Const $sIID_IBasicVideo = "{56A868B5-0AD4-11CE-B03A-0020AF0BA770}" Global Const $tagIBasicVideo = $tagIDispatch &amp; "get_AvgTimePerFrame hresult(double*);" &amp; "get_BitRate hresult(long*);" &amp; "get_BitErrorRate hresult(long*);" &amp; "get_VideoWidth hresult(long*);" &amp; "get_VideoHeight hresult(long*);" &amp; "put_SourceLeft hresult(long);" &amp; "get_SourceLeft hresult(long*);" &amp; "put_SourceWidth hresult(long);" &amp; "get_SourceWidth hresult(long*);" &amp; "put_SourceTop hresult(long);" &amp; "get_SourceTop hresult(long*);" &amp; "put_SourceHeight hresult(long);" &amp; "get_SourceHeight hresult(long*);" &amp; "put_DestinationLeft hresult(long);" &amp; "get_DestinationLeft hresult(long*);" &amp; "put_DestinationWidth hresult(long);" &amp; "get_DestinationWidth hresult(long*);" &amp; "put_DestinationTop hresult(long);" &amp; "get_DestinationTop hresult(long*);" &amp; "put_DestinationHeight hresult(long);" &amp; "get_DestinationHeight hresult(long*);" &amp; "SetSourcePosition hresult(long;long;long;long);" &amp; "GetSourcePosition hresult(long*;long*;long*;long*);" &amp; "SetDefaultSourcePosition hresult();" &amp; "SetDestinationPosition hresult(long;long;long;long);" &amp; "GetDestinationPosition hresult(long*;long*;long*;long*);" &amp; "SetDefaultDestinationPosition hresult();" &amp; "GetVideoSize hresult(long*;long*);" &amp; "GetVideoPaletteEntries hresult(long;long;long*;long*);" &amp; "GetCurrentImage hresult(long*;long*);" &amp; "IsUsingDefaultSource hresult();" &amp; "IsUsingDefaultDestination hresult();" Global Const $sIID_IPropertyBag = '{55272a00-42cb-11ce-8135-00aa004bb851}' Global Const $tagIPropertyBag = 'Read hresult(wstr;variant*;ptr*);' &amp; 'Write hresult(wstr;variant);' Global Const $tagIVMRWindowlessControl = 'GetNativeVideoSize hresult(long*;long*;long*;long*);' &amp; 'GetMinIdealVideoSize hresult(long*;long*);' &amp; 'GetMaxIdealVideoSize hresult(long*;long*);' &amp; 'SetVideoPosition hresult(ptr;ptr);' &amp; 'GetVideoPosition hresult(ptr*;ptr*);' &amp; 'GetAspectRatioMode hresult(dword*);' &amp; 'SetAspectRatioMode hresult(dword);' &amp; 'SetVideoClippingWindow hresult(hwnd);' &amp; 'RepaintVideo hresult(hwnd;handle);' &amp; 'DisplayModeChanged hresult();' &amp; 'GetCurrentImage hresult(byte*);' &amp; 'SetBorderColor hresult(clr);' &amp; 'GetBorderColor hresult(clr*);' &amp; 'SetColorKey hresult(clr);' &amp; 'GetColorKey hresult(clr*);' Global Const $tagIVMRFilterConfig = 'SetImageCompositor hresult(ptr);' &amp; 'GetNumberOfStreams hresult(dword*);' &amp; 'SetRenderingPrefs hresult(dword);' &amp; 'GetRenderingPrefs hresult(dword*);' &amp; 'SetRenderingMode hresult(dword);' &amp; 'GetrenderingMode hresult(dword*);' Global Const $sIID_IVMRFilterConfig9 = '{5a804648-4f66-4867-9c43-4f5c822cf1b8}' Global Const $tagIVMRFilterConfig9 = 'SetImageCompositor hresult(ptr);' &amp; 'SetNumberOfStreams hresult(dword);' &amp; 'GetNumberOfStreams hresult(dword*);' &amp; 'SetRenderingPrefs hresult(dword);' &amp; 'GetRenderingPrefs hresult(dword*);' &amp; 'SetRenderingMode hresult(dword);' &amp; 'GetrenderingMode hresult(dword*);' Global Const $sIID_IVMRMixerControl9 = '{1a777eaa-47c8-4930-b2c9-8fee1c1b0f3b}' Global Const $tagIVMRMixerControl9 = 'SetAlpha(dword;float);' &amp; 'GetAlpha(dword;ptr*) ;' &amp; 'SetZOrder(dword;dword) ;' &amp; 'GetZOrder(dword;ptr*) ;' &amp; 'SetOutputRect(dword;ptr) ;' &amp; 'GetOutputRect(dword;ptr*) ;' &amp; 'SetBackgroundClr(dword) ;' &amp; 'GetBackgroundClr(ptr) ;' &amp; 'SetMixingPrefs(dword) ;' &amp; 'GetMixingPrefs(ptr*) ;' &amp; 'SetProcAmpControl(dword;ptr) ;' &amp; 'GetProcAmpControl(dword;ptr*) ;' &amp; 'GetProcAmpControlRange(dword;ptr*);' Global Const $sIID_IAMStreamConfig = '{c6e13340-30ac-11d0-a18c-00a0c9118956}' Global $FrameRate = 30 ; #VARIABLES#
